---
// src/pages/debug-game.astro
const slug = 'super-mario-bros'; // Un slug que sepas que existe
const API_URL = 'http://backend:8000/api';

let responseText: string | null = null;
let errorMessage: string | null = null;

try {
  const response = await fetch(`${API_URL}/games/${slug}`);
  const responseStatus = response.status;
  
  if (!response.ok) {
    errorMessage = `Error: ${responseStatus} ${response.statusText}`;
    responseText = await response.text();
  } else {
    responseText = JSON.stringify(await response.json(), null, 2);
  }
} catch (err) {
  errorMessage = `Error de conexión: ${err.message}`;
}
---

<html>
<head>
  <title>Debug Game API</title>
  <style>
    body { font-family: system-ui; background: #111; color: #eee; padding: 20px; }
    pre { background: #222; padding: 15px; border-radius: 5px; overflow: auto; }
    .error { color: #ff5555; }
  </style>
</head>
<body>
  <h1>Depuración de API de juegos</h1>
  <p>Intentando obtener detalles del juego con slug: <strong>{slug}</strong></p>
  
  {errorMessage && <div class="error">
    <h2>Error:</h2>
    <p>{errorMessage}</p>
  </div>}
  
  <h2>Respuesta:</h2>
  <pre>{responseText}</pre>
</body>
</html>