---
// frontend/src/pages/checkout/success.astro
import MainLayout from '../../layouts/MainLayout.astro';

// Obtener parámetros de la URL
const url = new URL(Astro.request.url);
const paymentId = url.searchParams.get('payment_id');
const paymentMethod = url.searchParams.get('method');
---

<MainLayout title="Pedido Completado - Retro Time">
  <div class="min-h-screen bg-gray-50 py-12">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Success Animation -->
      <div class="text-center mb-8">
        <div class="mx-auto flex items-center justify-center h-24 w-24 rounded-full bg-green-100 mb-4">
          <svg class="h-12 w-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
        </div>
        
        <h1 class="text-3xl font-bold text-gray-900 mb-2">¡Pedido Completado!</h1>
        <p class="text-lg text-gray-600">Tu pago ha sido procesado exitosamente</p>
      </div>

      <!-- Order Details Card -->
      <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
        <div class="border-b border-gray-200 pb-4 mb-4">
          <h2 class="text-xl font-semibold text-gray-900">Detalles del Pedido</h2>
        </div>

        <div class="space-y-3">
          <div class="flex justify-between text-sm">
            <span class="text-gray-600">Número de pedido:</span>
            <span class="font-medium text-gray-900">#{paymentId?.slice(-8) || 'XXXXXXXX'}</span>
          </div>
          
          <div class="flex justify-between text-sm">
            <span class="text-gray-600">Método de pago:</span>
            <span class="font-medium text-gray-900 capitalize">
              {paymentMethod === 'stripe' ? 'Tarjeta de Crédito' : 'PayPal'}
            </span>
          </div>
          
          <div class="flex justify-between text-sm">
            <span class="text-gray-600">Estado:</span>
            <span class="font-medium text-green-600">Completado</span>
          </div>
        </div>
      </div>

      <!-- Shipping Info -->
      <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
        <div class="flex items-center mb-4">
          <svg class="w-5 h-5 text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"></path>
          </svg>
          <h3 class="text-lg font-medium text-gray-900">Información de Envío</h3>
        </div>
        
        <div class="text-sm text-gray-600">
          <p class="mb-2">Tu pedido será enviado en las próximas 24-48 horas.</p>
          <p>Recibirás un email de confirmación con el número de seguimiento.</p>
        </div>
      </div>

      <!-- Next Steps -->
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
        <h3 class="text-lg font-medium text-blue-900 mb-2">¿Qué sigue?</h3>
        <ul class="space-y-2 text-sm text-blue-800">
          <li class="flex items-start">
            <svg class="w-5 h-5 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
            </svg>
            <span>Recibirás un email de confirmación en breve</span>
          </li>
          <li class="flex items-start">
            <svg class="w-5 h-5 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
            </svg>
            <span>Prepararemos tu pedido para el envío</span>
          </li>
          <li class="flex items-start">
            <svg class="w-5 h-5 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
            </svg>
            <span>Te notificaremos cuando tu pedido esté en camino</span>
          </li>
        </ul>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a 
          href="/profile/orders" 
          class="inline-flex items-center justify-center px-6 py-3 border border-gray-300 rounded-lg text-gray-700 bg-red-600 hover:bg-red-700 transition-colors duration-200"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
          </svg>
          Ver mis pedidos
        </a>
        
        <a 
          href="/catalog" 
          class="inline-flex items-center justify-center px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
          </svg>
          Seguir comprando
        </a>
      </div>
    </div>
  </div>

  <!-- Confetti Animation (opcional) -->
  <script>
    // Pequeña animación de celebración al cargar la página
    document.addEventListener('DOMContentLoaded', () => {
      const successIcon = document.querySelector('.bg-green-100') as HTMLElement;
      if (successIcon) {
        successIcon.style.transform = 'scale(0)';
        successIcon.style.transition = 'transform 0.5s ease-out';
        
        setTimeout(() => {
          successIcon.style.transform = 'scale(1)';
        }, 100);
      }
    });
  </script>
</MainLayout>